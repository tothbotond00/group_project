{"version":3,"file":"add_users.min.js","sources":["../src/add_users.js"],"sourcesContent":["/*global $ */\r\n/*eslint no-undef: \"error\"*/\r\n\r\nexport const init = (users, roles, size, contextid, groupid, groupusers) => {\r\n    $(function(){\r\n        //Buttons\r\n        const user_view = $('#user_view');\r\n        const add_line = '<button id=\"add_line\"' +\r\n            ' class=\"btn btn-outline-secondary btn-sm text-nowrap\" style=\"margin-bottom: 20px\"> Új Felhasználó</button>';\r\n        const send_data = '<button id=\"send_data\"' +\r\n            ' class=\"btn btn-success btn-sm text-nowrap\" style=\"margin-bottom: 20px\"> Felhasználók hozzáadása</button>';\r\n        user_view.append(add_line);\r\n        user_view.append('<br>');\r\n        user_view.append(send_data);\r\n\r\n        //Form\r\n        initilaiseForm(users, roles, groupusers);\r\n        if($('.form_element').length >= size){\r\n            $(\"#add_line\").prop('disabled', true);\r\n        }\r\n        else if ($('.form_element').length === 0) {\r\n            addFormElement(users, roles);\r\n        }\r\n\r\n        //Button Events\r\n        $(\"#add_line\").click(function() {\r\n            addFormElement(users,roles);\r\n            if($('.form_element').length >= size){\r\n                $(\"#add_line\").prop('disabled', true);\r\n            }\r\n        });\r\n        $(\"#send_data\").click(function(){\r\n            sendData(contextid, groupid);\r\n        });\r\n\r\n    });\r\n};\r\n\r\nexport const initilaiseForm = (users,roles,groupusers) => {\r\n    let i = 0;\r\n    // eslint-disable-next-line no-unused-vars\r\n    for (const [key, value] of Object.entries(groupusers)) {\r\n        const generated_div = generateFormElement(users, roles);\r\n        $(generated_div).insertBefore($(\"#add_line\"));\r\n        $(`.users:eq(${i})`).val(value.userid).change();\r\n        $(`.roles:eq(${i})`).val(value.roleid).change();\r\n        i++;\r\n    }\r\n    $('.delete_row').click(function(event) {\r\n        event.preventDefault();\r\n        $(this).closest('div').remove();\r\n        $('#add_line').prop('disabled', false);\r\n    });\r\n};\r\n\r\nexport const addFormElement = (users, roles) => {\r\n    $(generateFormElement(users, roles)).insertBefore($(\"#add_line\"));\r\n    $('.delete_row').click(function(event) {\r\n        event.preventDefault();\r\n        $(this).closest('div').remove();\r\n        $('#add_line').prop('disabled', false);\r\n    });\r\n};\r\n\r\nexport const generateFormElement = (users, roles) => {\r\n    let user_options = '';\r\n    let role_options = '';\r\n    // eslint-disable-next-line no-unused-vars\r\n    for (const [key, value] of Object.entries(users)) {\r\n        let name = value.lastname + \" \" + value.firstname;\r\n        let id = value.id;\r\n        user_options += `<option value=${id}>${name}</option>`;\r\n    }\r\n    // eslint-disable-next-line no-unused-vars\r\n    for (const [key, value] of Object.entries(roles)) {\r\n        let name =  value.name;\r\n        let id = value.id;\r\n        role_options += `<option value=${id}>${name}</option>`;\r\n    }\r\n    return '<div style=\"margin-bottom: 20px\" class=\"form_element\">' +\r\n                '<label for=\"users\">Felhasználó</label>\\n' +\r\n                '\\n' +\r\n                '<select name=\"users\" id=\"users\" class=\"custom-select users\" style=\"margin-right: 20px\">\\n' +\r\n                    user_options +\r\n                '</select>' +\r\n                '<label for=\"roles\">Szerepkör</label>\\n' +\r\n                '\\n' +\r\n                '<select name=\"roles\" id=\"roles\" class=\"custom-select roles\" style=\"margin-right: 20px\">\\n' +\r\n                    role_options +\r\n                '</select>' +\r\n                '<a class=\"action-icon delete_row\">' +\r\n                    '<i class=\"icon fa fa-trash fa-fw \" title=\"Delete\" role=\"img\" aria-label=\"Delete\"></i>' +\r\n                '</a>' +\r\n                '<br> ' +\r\n            '</div>';\r\n};\r\n\r\nexport const sendData = (contextid, groupid) => {\r\n    const formData = $(\"#user_view div\");\r\n    let sendArray = [];\r\n    $.each(formData, function(i, v) {\r\n        const div = $(v);\r\n        const userid = div.find( \"#users\").val();\r\n        const roleid = div.find( \"#roles\").val();\r\n        sendArray.push({\"userid\" : userid, \"roleid\" : roleid});\r\n    });\r\n    const json = JSON.stringify(sendArray);\r\n    $(`<form action=\"/mod/groupproject/user.php?id=${contextid}&groupid=${groupid}\" method=\"post\">\r\n        <input type=\"hidden\" name=\"jQueryData\" value='${json}'>\r\n        </form>`)\r\n        .appendTo('body').submit();\r\n};"],"names":["users","roles","size","contextid","groupid","groupusers","$","user_view","append","initilaiseForm","length","prop","addFormElement","click","sendData","i","key","value","Object","entries","generated_div","generateFormElement","insertBefore","val","userid","change","roleid","event","preventDefault","this","closest","remove","user_options","role_options","name","lastname","firstname","id","formData","sendArray","each","v","div","find","push","json","JSON","stringify","appendTo","submit"],"mappings":"8PAGoB,CAACA,MAAOC,MAAOC,KAAMC,UAAWC,QAASC,cACzDC,GAAE,iBAEQC,UAAYD,EAAE,cAKpBC,UAAUC,OAJO,mIAKjBD,UAAUC,OAAO,QACjBD,UAAUC,OAJQ,mIAOlBC,eAAeT,MAAOC,MAAOI,YAC1BC,EAAE,iBAAiBI,QAAUR,KAC5BI,EAAE,aAAaK,KAAK,YAAY,GAEG,IAA9BL,EAAE,iBAAiBI,QACxBE,eAAeZ,MAAOC,OAI1BK,EAAE,aAAaO,OAAM,WACjBD,eAAeZ,MAAMC,OAClBK,EAAE,iBAAiBI,QAAUR,MAC5BI,EAAE,aAAaK,KAAK,YAAY,MAGxCL,EAAE,cAAcO,OAAM,WAClBC,SAASX,UAAWC,sBAMnBK,eAAiB,CAACT,MAAMC,MAAMI,kBACnCU,EAAI,MAEH,MAAOC,IAAKC,SAAUC,OAAOC,QAAQd,YAAa,OAC7Ce,cAAgBC,oBAAoBrB,MAAOC,OACjDK,EAAEc,eAAeE,aAAahB,EAAE,cAChCA,sBAAeS,QAAMQ,IAAIN,MAAMO,QAAQC,SACvCnB,sBAAeS,QAAMQ,IAAIN,MAAMS,QAAQD,SACvCV,IAEJT,EAAE,eAAeO,OAAM,SAASc,OAC5BA,MAAMC,iBACNtB,EAAEuB,MAAMC,QAAQ,OAAOC,SACvBzB,EAAE,aAAaK,KAAK,YAAY,oDAI3BC,eAAiB,CAACZ,MAAOC,SAClCK,EAAEe,oBAAoBrB,MAAOC,QAAQqB,aAAahB,EAAE,cACpDA,EAAE,eAAeO,OAAM,SAASc,OAC5BA,MAAMC,iBACNtB,EAAEuB,MAAMC,QAAQ,OAAOC,SACvBzB,EAAE,aAAaK,KAAK,YAAY,oDAI3BU,oBAAsB,CAACrB,MAAOC,aACnC+B,aAAe,GACfC,aAAe,OAEd,MAAOjB,IAAKC,SAAUC,OAAOC,QAAQnB,OAAQ,KAC1CkC,KAAOjB,MAAMkB,SAAW,IAAMlB,MAAMmB,UACpCC,GAAKpB,MAAMoB,GACfL,sCAAiCK,eAAMH,sBAGtC,MAAOlB,IAAKC,SAAUC,OAAOC,QAAQlB,OAAQ,KAC1CiC,KAAQjB,MAAMiB,KACdG,GAAKpB,MAAMoB,GACfJ,sCAAiCI,eAAMH,wBAEpC,4LAISF,aAJT,6IASSC,aATT,0MAkBEnB,SAAW,CAACX,UAAWC,iBAC1BkC,SAAWhC,EAAE,sBACfiC,UAAY,GAChBjC,EAAEkC,KAAKF,UAAU,SAASvB,EAAG0B,SACnBC,IAAMpC,EAAEmC,GACRjB,OAASkB,IAAIC,KAAM,UAAUpB,MAC7BG,OAASgB,IAAIC,KAAM,UAAUpB,MACnCgB,UAAUK,KAAK,QAAYpB,cAAmBE,kBAE5CmB,KAAOC,KAAKC,UAAUR,WAC5BjC,wDAAiDH,8BAAqBC,4FAClByC,6BAE/CG,SAAS,QAAQC"}